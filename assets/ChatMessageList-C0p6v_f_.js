import{R as N,j as e}from"./motion-vendor-B3aZs4py.js";import{ap as y,aq as d,an as k,r as $,s as C,_ as E}from"./icons-vendor-BvleUy3r.js";import"./react-vendor-DlBnNAMw.js";const B=({messages:i,isDarkMode:r,theme:c,currentTheme:x,renderMessage:h,handleSpeak:u,isLoading:b,loadingText:m,chatEndRef:g,setFullPreviewImage:w,expandedMessages:j={},toggleMessageExpand:p,messageRefs:f={current:[]}})=>{const s=x?.chatColors||{userBubble:{light:"bg-[#5D737E] text-white border-[#4A606A]",dark:"bg-sky-800 text-white border-sky-700"},modelBubble:{light:"bg-white/90 backdrop-blur-sm text-stone-700 border-stone-200",dark:"bg-neutral-800/90 backdrop-blur-sm text-neutral-200 border-neutral-700"},bg:{light:"bg-[#F9F9F6]/50",dark:"bg-black/20"}};return e.jsxs("div",{className:`flex-1 overflow-y-auto overflow-x-hidden p-4 space-y-4 ${r?s.bg.dark:s.bg.light}`,children:[i.map((t,l)=>e.jsxs("div",{className:`flex gap-3 ${t.role==="user"?"flex-row-reverse":""}`,children:[e.jsxs("div",{className:"flex flex-col items-center gap-1 flex-shrink-0",children:[e.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center shadow-sm border
                ${t.role==="user"?r?"bg-sky-800 text-white border-sky-700":"bg-[#5D737E] text-white border-[#4A606A]":r?"bg-neutral-800 text-sky-300 border-neutral-700":"bg-white text-[#5D737E] border-stone-200"}`,children:t.role==="user"?e.jsx(y,{className:"w-5 h-5"}):e.jsx(d,{className:"w-5 h-5"})}),t.role==="model"&&e.jsx("button",{onClick:()=>u(t.text),className:`p-1 rounded-full transition-all ${r?"text-sky-300 hover:bg-neutral-700":"text-[#5D737E] hover:bg-stone-200"}`,title:"朗讀訊息",children:e.jsx(k,{className:"w-3.5 h-3.5"})})]}),e.jsx("div",{ref:a=>f.current[l]=a,className:"max-w-[75%] group relative transition-all duration-300",children:e.jsxs("div",{className:`p-3.5 rounded-2xl text-sm leading-relaxed whitespace-pre-wrap break-words shadow-sm border
                ${t.role==="user"?r?s.userBubble.dark+" rounded-tr-none":s.userBubble.light+" rounded-tr-none":r?s.modelBubble.dark+" rounded-tl-none":s.modelBubble.light+" rounded-tl-none"}`,children:[t.image&&e.jsx("img",{src:t.image,alt:"Sent Image",onClick:()=>w(t.image),className:"mb-2 max-w-full h-auto rounded-lg border border-white/20 shadow-sm object-cover cursor-zoom-in active:scale-95 transition-transform"}),(()=>{const a=t.text?.length||0,n=a>150,o=j[l],v=n&&!o;return e.jsxs("div",{children:[e.jsx("div",{className:v?"line-clamp-4":"",children:h(t.text)}),n&&e.jsx("button",{onClick:()=>p(l),className:`mt-2 flex items-center gap-1 text-xs font-medium transition-all hover:opacity-80 ${t.role==="user"?"text-white/90":r?"text-sky-400":"text-[#5D737E]"}`,children:o?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-3.5 h-3.5"}),"收起"]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-3.5 h-3.5"}),"展開完整內容 (",a," 字)"]})})]})})()]})})]},l)),b&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center shadow-sm border ${r?"bg-neutral-800 border-neutral-700":"bg-white border-stone-200"}`,children:e.jsx(d,{className:`w-5 h-5 ${r?"text-sky-300":"text-[#5D737E]"}`})}),e.jsxs("div",{className:`p-3 rounded-2xl rounded-tl-none border shadow-sm flex items-center gap-2 ${r?"bg-neutral-800/60 border-neutral-700":"bg-white/80 border-stone-200"}`,children:[e.jsx(E,{className:`w-4 h-4 animate-spin ${r?"text-sky-300":"text-[#5D737E]"}`}),e.jsx("span",{className:`text-xs ${c.textSec}`,children:m||"正在翻閱您的行程表..."})]})]}),e.jsx("div",{ref:g})]})},R=N.memo(B);export{R as default};
